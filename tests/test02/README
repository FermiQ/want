
==============================================================================
@title@   FCC Transition Metals  (Co and Cu, NC and USPP)
==============================================================================

  This test performs the calculation of the Wannier functions for some
  typical transition metal FCC bulk crystals, such as Cu and Co. No transport 
  calculation is done. Calculations are performed both with NC and US pseudopots 
  for Copper and only with US pseudopot for Cobalt.
  Particular interest is connected with the cutoff convergence (both wfc and rho)
  in the Co case where the augmentation charge is supposed to be quite hard.

  The band structure along standard symmetry lines is computed by the DFT code
  (see the files $TESTDIR/Reference/dft_band_Cu.dat, 
  $TESTDIR/Reference/dft_band_CuUS.dat, $TESTDIR/Reference/dft_band_CoUS.dat)
  and then recalculated by interpolation on the Wannier function Hamiltonian.

  Disentangle calculation is performed using Bloch states up to 19.78 eV upper-
  bound for Cu (20.04 eV for Cu with US pp and 28.00 eV for Co). States are 
  frozen up to the Fermi energy level (12.7979 eV for Cu, 13.0588 eV for CuUS 
  and 11.6181 eV for Co). Six initial guess centers of 1gauss type are considered: 
  5 with d-type and 1 with s-type geometry, localized on the Cu (or Co) atom (see 
  the manual for further details).


  RESULTS discussion

  Nearest neighbours b-shell vectors, computed by disentangle, DFT eigenvalues
  and frozen states are reported on the disentangle output file. Disentangle
  convergence is achieved in about 40 iterations for copper (about 70 for cobalt)
  and the final invariant spread (\Omega_I) is about 12.197 Bohr^2 for Cu 
  (13.068 Bohr^2 for CuUS and 11.421 Bohr^2 for Co), 2.033 Bohr^2 on average 
  (2.178 Bohr^2 for CuUS and 1.903 Bohr^2 for Co): this component of the spread 
  will remain unchanged during the Wannier localization.

  After about 260 iterations Wannier convergence for copper is achieved. A total 
  spread of about 15.716 Bohr^2 for Cu (16.009 Bohr^2 for CuUS) is found, with an 
  average of about 2.619 Bohr^2 for Cu (2.668 Bohr^2 for CuUS).
  After 2000 iterations Wannier convergence for cobalt is not fully achieved but 
  can be considered adequate. A total spread of about 19.421 Bohr^2 is found (with 
  an average of about 3.237 Bohr^2).

  In every case the computed localization of Wannier functions is verified:

      * Average invariant spread is small (in the range 1. -- 2. Bohr^2).

      * Final average total spreads are small ( between 2. -- 3. Bohr^2).

      * Hamiltonian matrix elements are nearly real. See the end of wannier.out 
        file where these matrix elements are reported.

      * The spatial decay of the hamiltonian on the WF basis H(R) is well behaved.

      * A comparison between DFT and interpolated Wannier band structure can be done. 
        The files to be plotted are:
            $TESTDIR/Reference/dft_bands_Cu.dat (or _CuUS or _CoUS)
            $TESTDIR/SCRATCH/copper_WanT_intband.dat (or copper_US or cobalt_US if 
            the case)

        Interpolated bands don't fit exactly DFT bands because the kpoints convergence
        is not fully achieved: it would require a further run with a (8 8 8) or 
        (10 10 10 ) kpoints grid (use kgrid.x program in $TOPDIR/utility to get 
        the grid).  The minimization procedure will be complex and will require many 
        more iteration steps, but DFT bands will be well reproduced  
        (see Souza, Marzari and Vanderbilt, Phys. Rev. B 65, 035109, 2002)
        Even if states are frozen up to the Fermi level, bands are not perfectly 
        interpolated up to this energy because they are calculated along standard 
        symmetry lines and not on the same kpoints where the states are frozen. 

        The effect of disentangle on the Wannier subspace can be seen also in the
        files:
            $TESTDIR/SCRATCH/copper_WanT_dftband.dat (or copper_US or cobalt_US)
            $TESTDIR/SCRATCH/copper_WanT_wanband.dat (or copper_US or cobalt_US)
        describing Bloch eigenvalues before and after disentangle procedure.
        If the frozen states condition is present, band structures in _dftband.dat 
        and _wanband.dat files must be completely overlapping, up to the frozen energy
        level.

   Norm-conserving and Ultra-soft calculations (in the copper case) show some small
   differences which can be safely attributed to the pseudopotentials and their 
   pseudization types.


