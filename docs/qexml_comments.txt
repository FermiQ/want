
Alcuni commenti sul formato xml di espresso:

1) e' molto comodo che dal file xml principale partano dei link iotk verso 
   tutti gli altri file, siano essi testuali o binati...
   questo mi sembra che sia verificato sempre, a parte per la densita'.

2) CELL: mentre i vettori di reticolo diretto sono dati in bohr, quelli
         di reticolo reciproco sono in tpiba = 2 Pi / alat ;
         e' utile mantenere questa asimmetria ?? (invece che, ad esempio usare 
         bohr & bohr^-1  o, perche' no, alat & tpiba)

3) SYMMETRY: per rileggere la grandezza   irt(nsym, nat) occorre conoscere il
         numero di atomi, che non e' passato alla subroutine... sarebbe utile
         aggiungerlo altrimenti si impone un ordine di lettura (prima IONS, poi SYMM)

4) XC: nsp e' usato ma non scritto nei pressi.. sarebbe comodo ripetere il dato
       evitando cosi' di supporre che si sia gia' letto la tag IONS
@@ ok @@

5) OCC: la stessa cosa di prima, nelup e neldw (e lsda) sono usati per dimensionare ma non
        scritti
@@ ok @@

6) BAND_STRCUTURE:  ci sono tutte le dimensioni tranne il numero di kpt
@@ ok @@

7) UNITS: molto comodo avere le unita' riportate su tutti i dati.
          quando ci sono serie di oggetti ( tutti i vettori tau, tutte le symmetrie ecc ecc)
          secondo me e' molto piu' comodo definire le unita' una volta per tutte con una
          tag apposita (come fatto per i tau, per i kpt, per i q dei fononi), e non 
          farlo oggetto per oggetto (come nelle simmetrie, dove ciascuna operazione 
          ha la sua unita' come attributo)

          questo secondo caso e' appena piu' generale, ma non credo che  nessuno vorrebbe
          usare unita' differenti per diverse operazioni di simmetria scritte dallo
          stesso loop... nello stesso modo e' molto piu' sporco da gestire in lettura:
          
          io vorrei leggere le unita' delle simmetrie, a questo punto leggo la prima
          e spero che tutte le altre siano uguali, perche' non vorrei fare uscire dalla
          routine di lettura un array di unita' di misura (una per ogni simmetria e alla 
          fine tutte uguali)

          oltre alle simmetrie, questo succede anche per i vettori a1,a2,a3 b1,b2,b3
          (+ alat) nella sez CELL, per i cutoff nella sez PLANE_WAVES. 
          !
          forse anche in BAND_STRUCTURE si potrebbe definire una UNITS_FOR_ENERGY
          globale (e non una per l'energia di fermi, e unaper ciascun autovalore...)
         
8) IOTK LINK: 
          per chiarezza, i nomi delle tag con link iotk dovrebbero essere anche i
          nomi di root nel file puntato....

          ad esempio, in pw_export, nel file principale:

          <Main_grid iotk_link="mgrid">
          </Mian_grid>

          corrisponde alla tag
      
          <Main_grid >    nel file mgrid

          questo non e' fatto nei link del nuovo formato... 
          (  G-VECTORS_FILE, GK-VECTORS, WFC ), anche se, ho verificato, 
          i link si riesce comunque ad utilizzare.. semplicemente la tag di 
          root file punto non viene utilizzata.

9) GK-VECTORS:  la tag K-POINT.x   all'interno del file K0000x/gkvectors.dat
          si potrebbe eliminare perche' non serve e complica solo le cose
          facendo il search dal file principale la gerarchia e':

          BAND_STRUCTURE
            EIGENVALUES_AND_EIGENVECTORS
              K-POINT.1
                GK-VECTORS     (e qui c'e' il link iotk a gkvectors.dat)
                  K-POINT.1
                     ...

10) GK GRIDS:   sarebbe utile avere i dimensionamenti delle griglie g+k (npw e npwx)
          vicini (cioe' nella stessa sezione) a dove si leggono le griglie...    
          si potrebbe anche addiungere una sezione INFO (come in evc.dat) anche ai file
          gkvectors.dat
@@ ok @@
          

** ACTUNG **
11) MAX_NPW:    viene scritto da write_planewaves (xml_io_base.f90); 
          la chiamata e' in pw_restart e alla routine viene passato npwx (che verra'
          scritto come MAX_NPW ); 
          secondo me invece di npwx, si dovrebbe passare npwx_g ...
          (ho verificato con un conto in parallelo ed effettivamente il numero varia
           al variare del numero di proc)
** ACTUNG **

@@ ok @@

12) WFC:  mi pare che le wfc siano scritte sui primi termini della griglia G 
          della densita' in modo k indipendente...
          cosi direi pero' che le griglie riportate in gkvectors non servono
          quasi a nulla...  forse sarebbe meglio riportare le wfc nel modo classico
          (date le grigli k-dipendenti, scrivo i coefficienti per ig = 1, npw(ik) )
          e poi, quando interessasse, si potrebbe cmq fare il passaggio alla griglia
          k indip in modo facile...  

          nel caso con NSPIN=2, mentre per ogni kpt ci sono autovalori ed occupazioni
          labellate per ispin = 1,2 ( ET.1, OCC.1 , ET.2, OCC.2 ), per le WFC ci sono
          due tag con lo stesso nome WFC (che puntano rispettivamente a evc1.dat ed evc2.dat)
         ... bisognerebbe mettere l'indice di spin anche qui

@@ ok @@

13) UNITS in gkvectors: sono riportate delle Hartree Units... 
          sembra che ci sia un ATTR=attr di troppo quando si 
          scrive K-POINT.x  in wrtie_gk ( pw_restart.f90, line 680 )

14) scrivere versione di espresso che ha generato il file
    definire e scrivere versione (decisamente piu' importante) del formato.
           

